---
title: 图论笔记——道路与回路
published: 2025-10-27
pinned: false
updated: 2025-10-27
description: 这是我离散数学课程的笔记
image: ""
tags:
  - 笔记
  - 图论
password: ""
encrypted: true
category: 笔记
licenseName: MIT
sourceLink: ""
draft: false
---
### 有向道路与有向回路（有向图）

* **有向道路**: 有向图G中边序列 $P=(e_{i1},e_{i2},...,e_{iq})$,其中 $e_{ik}=\langle v_{l},v_{j}\rangle$ 满足: $v_{l}$ 是 $e_{i(k-1)}$ 的终点, $v_{j}$ 是 $e_{i(k+1)}$ 的始点,称边序列P是图G中的一条有向道路。
* **有向回路**: $e_{iq}$ 的终点也是 $e_{i1}$ 的始点,则称边序列P是图G中的一条有向回路。
* **简单有向道路/回路**: P中**边**不重复出现。
* **初级有向道路/回路**: P中**结点**不重复出现。
* **初级有向道路/回路一定是简单有向道路/回路**。
### 道路与回路 (无向图）

* **道路/链**: 无向图G中点边交替序列 $P=(v_{i_{1}},e_{i_{1}},v_{i_{2}},e_{i_{2}},...,e_{i_{q-1}},v_{i_{q}})$
    * 满足: $v_{ij}$ 和 $v_{ij+1}$ 是 $e_{ij}$ 的两个端点, 称序列P是图G中的一条链或道路。
* **回路/圈**: 如果 $v_{i_{q}}=v_{i_{1}},$ 则称序列P是G中的一个圈或回路。
* **简单道路/回路**: P中**边**不重复出现。
* **初级道路/回路**: P中**结点**不重复出现。
* **简单图的道路可用结点来表示**。
### 其它相关定义

* **极大路径**: P为一条**初级道路**,其始点与终点都不与P外的顶点相邻。 (路径: 初级道路)
* **短程线**: 两结点间长度最短的道路。
* **距离**: 短程线的长度 $d(v_{1},v_{2})$。
* **弦**: 设C为简单图G中含结点数大于3的一个初级回路,如果结点 $v_{i}$ 和 $v_{j}$ 在C中不相邻,而边 $(v_{i},v_{j})\in E(G)$,则称 $(v_{i},v_{j})$ 是C的一条弦。
    * 若对每一个 $v_{k}\in V(G)$,都有 $d(v_{k})\ge3$,则G中必含有带弦的回路。
---
* **连通**: 若无向图G的任意两个结点之间都存在道路,称G是连通的。
* **(弱)连通**: 对有向图G,若不考虑边的方向时是连通的,则称G是(弱)连通的。
* **单向连通图**: 对有向图G,对任意 $v_{i}, v_{j}\in V$, $v_{i}\rightarrow v_{j}$ 与 $v_{j}\rightarrow v_{i}$ 至少成立其一,则称G为单向连通图。
* **强连通图**: 对有向图G,对任意 $v_{i}, v_{j}\in V$, $v_{i}\rightarrow v_{j}$ 与 $v_{j}\rightarrow v_{i}$ 均成立,则称G为强连通图。
    * 有向图G是强连通图当且仅当在G中存在经过每个顶点至少一次的回路。
* **连通支**: 若G的连通子图H不是G的任何连通子图的真子图,称H是G的极大连通子图,或称连通支。
    * G的每个连通支都是它的导出子图。
    * 任何非连通图都是2个以上连通支的并。
* **割点**: 设 $v$ 是G的一个结点,若 $G-v$ 的连通支数比G多,则称 $v$ 是G的一个割点。（说人话就是删掉这个点，一个连通图变成两个了）
* **割边(也称作桥)**: 设 $e$ 是G的一条边,若 $G-e$ 的连通支数比G多,则称e是G的一个割边。（和割点的定义相似，把点换成边罢了）
### 二分图

* **二分图**: 若 $G=(V,E)$ 为无向图,如果 $V(G)$ 可划分成子集 $V_{1}$ 和 $V_{2}$,使得G中每条边的两个结点一个属于 $V_{1}$,另一个属于 $V_{2}$,则称G是二分图。
* **完全二分图**: 若 $G=(V,E)$ 为简单二分图,如果 $V_{1}$ 中的每个结点均与 $V_{2}$ 中的所有结点相邻,则称G是完全二分图,记为 $K_{s,t}$,其中 $s=|V_{1}|,t=|V_{2}|$。
* **性质**: 如果二分图G中存在回路,则它们都是由偶数条边组成的。
* **二分图判别定理**: 无向图G为二分图的**充分必要条件**是 **G中无奇数条边组成的回路**。
    * **证明 (必要性)**: G为二分图 => 无奇数条边的回路
        * a) 若G中无回路,显然G无奇数条边的回路。
        * b) 若G中有回路,记为C,令 $C=v_{i1}v_{i2}...v_{il}v_{i1}, l\ge2$。不妨设 $v_{i1}\in V_{1}$,因为G为二分图,故 $v_{i2}\in V_{2}$, $v_{i3}\in V_{1}$,依次最后 $v_{il}\in V_{2}$ (因为 $v_{il}$ 与 $v_{i1}$ 相邻),故 $l$ 必为偶数 => 无奇数条边构成的回路。
    * **证明 (充分性)**: 无奇数条边构成的回路 => 二分图
        * 不妨设G为连通图: $v_{0}$ 为G中任意一点。定义两个集合:
        * $V_{1}=\{v|v\in V(G)$ 且与 $v_{0}$ 的距离为偶数}
        * $V_{2}=\{v|v\in V(G)$ 且与 $v_{0}$ 的距离为奇数}
        * 显然: $V_{1}\ne\emptyset$, $V_{2}\ne\emptyset$, $V_{1}\cap V_{2}=\emptyset$, $V_{1}\cup V_{2}=V(G)$
        * 只需证明 $V_{1}$ 中任意两点不相邻且 $V_{2}$ 中任意两点也不相邻。
        * 反证法:若存在 $v_{i},v_{j}\in V_{1}$ 且相邻,令 $e=(v_{i},v_{j})$。 令 $v_{0}$ 到 $v_{i}, v_{j}$ 的短程线分别为 $P_{i}, P_{j}$。 $\Rightarrow P_{i}$ 与 $P_{j}$ 与e构成长度为奇数的回路,与条件矛盾,得证。

---
### 欧拉道路与回路

* **欧拉回路**: 连通图G中一条**经过所有边**的简单回路。
* **欧拉图**: 具有欧拉回路的图。
* **欧拉道路**: 连通图G中一条经过所有边的简单道路。
* **欧拉半图**: 具有欧拉道路但无欧拉回路的图。
### 欧拉图判定定理

* **定理1**: **无向**连通图G中存在欧拉回路的**充要条件**是 **G中各结点的度都是偶数**。
    * **证明 (必要性)**: 令P是欧拉图G的欧拉回路。 当P经过任意一顶点时,该点总有进出两个方向的边; 每条边仅经过一次,所以每个顶点必是偶数度数。
    * **证明 (充分性)**: 对图G的边数m进行归纳证明。
        * 当 $m=1$ 时,图G只能是个环,因此图G总是欧拉图。
        * 假设当 $m\le k$ 时结论成立,证明 $m=k+1$ 时结论也成立。
        * 1). 连通图G顶点度数为偶数 => 图G中含有一条简单回路C;
        * 2). 去掉简单回路C的边,生成p个连通分支 $G_{i} (i=1,2,...,p)$,连通分支 $G_{i}$ 边小于等于k且顶点度数为偶数 => 欧拉图;
        * 3). 从C中任意一点出发,沿边走到与连通分支 $G_{i}$ 的公共点 $u_{i}$, 然后通过 $G_{i}$ 的欧拉回路回到 $u_{i}$;;依次继续进行到另一个连通分支,最后到达出发点,得到G的欧拉回路。
* **定理2**: **无向**连通图G中存在欧拉道路(欧拉半图)的**充要条件**是 **G中只有两个度为奇数的结点**。
    * **证明**: 连接这两顶点,则有欧拉回路;再删去这条边。(欧拉道路的始点和终点必须选在奇数度点)
* **定理3**: **有向**连通图G是欧拉图的**充分必要条件**是图中各点的 **入度和出度相等**。
* **定理4**: **有向**连通图 G是欧拉半图的**充分必要条件**是图中**至多有两个顶点,其中一个顶点的入度比出度多1,另一个顶点的出度比入度多1,其它顶点入度和出度相等**。（这些都和无向图相关的条件相似）
### 寻找欧拉回路

* **逐步插入回路**: 根据定理1中证明过程。
* **Fleury 算法**
    * **基本思想**: 能不走桥就不走桥。
    * **输入**: 欧拉图G
    * (1) 任取 $v_{0}\in V(G)$, 令 $P_{0}=v_{0}$, $i=0$;
    * (2) 令 $P_{i}=v_{0}e_{1}v_{1}e_{2}v_{2}\cdot\cdot\cdot e_{i}v_{i}$。 如果 $E(G)-\{e_{1},e_{2},\cdot\cdot\cdot,e_{i}\}$ 中没有与 $v_{i}$ 关联的边,计算停止; 否则按下述条件从 $E(G)-\{e_{1},e_{2},\cdot\cdot\cdot,e_{i}\}$ 中任取一条边 $e_{i+1}$:
        * (a) $e_{i+1}$ 与 $v_{i}$ 相关联;
        * (b) 除非无别的边可供选择,否则 $e_{i+1}$ 不应该选 $G-\{e_{1},e_{2},\cdot\cdot\cdot,e_{i}\}$ 的桥。
    * 设 $P_{i+1}\leftarrow v_{0}e_{1}v_{1}e_{2}v_{2}\cdot\cdot\cdot e_{i}v_{i}e_{i+1}v_{i+1}$;
    * (3) 令 $i=i+1$,返回(2).

---
### 哈密顿道路与回路

* **哈密顿回路(道路)**: 无向图G中的一条经过**全部结点**的 **初级** 回路(道路)。
* **哈密顿回路(道路)**: 简称为H回路(道路)。
* **哈密顿图**: 具有H回路的图。
* **哈密顿半图**: 具有H道路但无H回路的图。
### H回路问题说明

* H回路是**初级回路**。
* 要求 $V(G)=n\ge3$。
* 只需考虑**简单图**,因为重边和自环不起作用。
* 完全图 $K_{n}(n\ge3)$ 中存在H回路。
* H回路的判定比较困难,没有发现充分必要的条件,只有若干**充分**条件。
### 判定定理与推论

#### H图的充分条件 (判定存在)

* **定理1**: 若简单图 $G(n\ge3)$ 的任意两结点 $v_{i}$ 与 $v_{j}$ 之间恒有 $d(v_{i})+d(v_{j})\ge n-1$, 则简单图G中存在H道路。
    * **证明**:
        * (1) **首先证明G是连通图**。 假设G非连通,有2个连通支 $G_{1}$ 和 $G_{2}$, $|V(G_{1})|=n_{1}, |V(G_{2})|=n_{2}$。 各取 $v_{i}\in G_1$ 和 $v_{j}\in G_2$,则有 $d(v_{i})\le n_{1}-1$ 且 $d(v_{j})\le n_{2}-1$ $\Rightarrow d(v_{i})+d(v_{j})\le (n_1-1) + (n_2-1) = n-2 < n-1$。 这与 $d(v_i)+d(v_j)\ge n-1$ 矛盾。 所以图G是连通图。
        * (2) **证明G中存在H道路 (寻找H道路)**。
        * 设 $P=v_{1}v_{2}\cdot\cdot\cdot v_{l}$ 是G中一条 **极大路径**, $l\le n$。 (极大路径: 始点 $v_1$ 和终点 $v_l$ 均不与P外的结点相邻)
        * (a) 若 $l=n$,则P是为G中的H道路。
        * (b) 若 $l<n$, 则G中存在P外的结点。 需证G中存在过P上所有点的初级回路。
            * 【1】若 $v_{1}$ 与 $v_{l}$ 相邻,即 $P\cup(v_{1},v_{l})$ 为满足要求的初级回路。
            * 【2】若 $v_{1}$ 与 $v_{l}$ 不相邻, 设 $v_{1}$ 与P上k个结点 $v_{i_{1}}=v_{2},v_{i_{2}},\cdot\cdot\cdot,v_{i_{k}}$ 相邻。
            * (若 $k=1$, 则 $d(v_{1})=1$, $d(v_{l})\le l-2$, $d(v_{1})+d(v_{l})\le l-1<n-1$,矛盾。 故 $k\ge2$。)
            * 设 $v_{1}$ 与P上的 $v_{i_{1}}=v_{2},v_{i_{2}},\cdot\cdot\cdot,v_{i_{k}}$ 相邻 ($k\ge2$)。
            * $v_{l}$ 至少与 $v_{i_{2}-1},v_{i_{3}-1},\cdot\cdot\cdot,v_{i_{k}-1}$ 之一相邻。
            * 否则,由 $d(v_1) = k$, $d(v_{l})\le l-2-(k-1)$。
            * $\Rightarrow d(v_{1})+d(v_{l})\le l-1<n-1$,矛盾。
            * 设 $v_{l}$ 与 $v_{i_{r}-1}$ 相邻 $(2\le r\le k)$。
            * 则存在初级回路 $C=v_{1}v_{2}\cdot\cdot\cdot v_{i_{r}-1}v_{l}v_{l-1}\cdot\cdot\cdot v_{i_{r}}v_{1}$。
        * (c) **证明存在比P更长的路径**。
        * 由G的连通性知,存在 $v_{l+1}\in V(G)-V(P)$ 与P上的某结点 $v_{t}$ 相邻。
        * 当 $t<i_{r}-1$ 时,删除边 $(v_{t-1},v_{t})$。
        * 路径 $P^{\prime}=v_{t-1}\cdot\cdot\cdot v_{1}v_{i_{r}}\cdot\cdot\cdot v_{l}v_{i_{r}-1}\cdot\cdot\cdot v_{t}v_{l+1}$
        * 构造比P长度大1的路径。
        * 当 $t \ge i_r - 1$ 时，类似构造。
        * 重复上面步骤(2),直至 $l+1=n$,可得出图G的H道路。

* **推论1**: 若简单图 $G(n\ge3)$ 的任意两结点 $v_{i}$ 与 $v_{j}$ 都满足 $d(v_{i})+d(v_{j})\ge n$,则图G中存在H回路。
    * **证明**: 由定理1可知,图G中存在哈密顿道路,记为 $P=v_{1}v_{2}\cdot\cdot\cdot v_{n}$。
    * (1) 若 $v_{1}, v_{n}$ 相邻,即 $(v_{1},v_{n})\in E(G)$,则 $P\cup(v_{1},v_{n})$ 定为H回路;
    * (2) 若 $v_{1}, v_{n}$ 不相邻, 按照定理1的证明方法(b), $d(v_1)+d(v_n) \ge n$ ( $l=n$ ), 可得存在过P上各结点的初级回路,即H回路。 (回路 $C=v_{1}v_{2}\cdot\cdot\cdot v_{i_{r}-1}v_{n}v_{n-1}\cdot\cdot\cdot v_{i_{r}}v_{1}$)

* **推论2**: 若简单图 $G(n\ge3)$ 的任一结点的度大于等于 $n/2$, 则G中存在H回路。
    * **证明**: 推论1的直接结果。
    * **示例**: 判断 $K_{3,3}$ 是否有H回路? $n=6$, $n/2=3$。所有结点的度 $d(v)=3$。 满足推论2, 存在H回路。

* **引理1**: 若简单图 $G(n\ge3)$ 有不相邻结点 $v_{i}$ 与 $v_{j}$ 满足 $d(v_{i})+d(v_{j})\ge n$,则G存在H回路当且仅当 $G+(v_{i},v_{j})$ 有H回路。
    * **证明**:
        * (必要性) G存在H回路则 $G+(v_{i},v_{j})$ 存在H 回路,显然成立。
        * (充分性) 证明当 $G+(v_{i},v_{j})$ 有H回路时,G存在H回路。
        * 反证法: 假设G无H回路。
        * 则 $G+(v_{i},v_{j})$ 的H回路必经过边 $(v_{i},v_{j})$。
        * 删除 $(v_{i},v_{j}) \Rightarrow G$ 中存在以 $v_{i},v_{j}$ 为端点的H道路(极大路径)。
        * G无H回路即无初级回路两个端点的度满足 $d(v_{i})+d(v_{j})\le n-1 < n$ (第12页辅助结论)。
        * 这与引理条件 $d(v_{i})+d(v_{j})\ge n$ 矛盾,得证。

* **闭合图**: 若 $v_{i}$ 和 $v_{j}$ 是简单图G的不相邻结点,且满足 $d(v_{i})+d(v_{j})\ge n$,则令 $G^{\prime}=G+(v_{i},v_{j})$,对G'重复上述过程,直至不再有这样的结点对为止。最终得到的图称为G的闭合图,记作 $C(G)$。
* **引理2**: 简单图G的闭合图是唯一的。
* **引理3**: 简单图G有H回路当且仅当 $C(G)$ 有H回路。
    * **证明**: 设 $C(G)=G\cup L_{1}$, $L_{1}=\{e_{1},e_{2},\cdot\cdot\cdot,e_{l}\}$。
    * G有H回路 $\iff$ $G+e_{1}$ 有H回路 $\iff$ $G\cup \{e_{1}, e_{2}\}$ 有H回路 $\iff ... \iff C(G)$ 有H回路。
* **推论3**: 若 $C(G)=K_{n}$,则G有H回路。

#### H图的必要条件 (判定不存在)

* **定理2**: 设G是哈密顿图,则对任意的非空点集 $V_{1}\subset V(G)$,图 $G-V_{1}$ 中的连通支数不大于 $|V_{1}|$。
    * **证明**: 设C为G的任意一条哈密顿回路。
    * 若 $V_{1}$ 中结点在C中互不相邻, $C-V_{1}$ 的连通支达到最大 $|V_{1}|$。
    * 若 $V_{1}$ 中结点在C中有相邻, $C-V_{1}$ 的连通支小于 $|V_{1}|$。
    * 所以, $C-V_{1}$ 的连通支不大于 $|V_{1}|$。
    * 又因为C是G的支撑子图, 则 $G-V_{1}$ 的连通支小于等于 $C-V_{1}$ 的连通支数。
* **定理2推论**: 奇数个结点构成的二分图不是哈密顿图。
    * **示例 (推论应用)**: 判断右图是否为哈密顿图？ (一个13个结点的二分图)
    * 该图为二分图, 结点集 $V_1 = \{a,b,c,d,e,f\}$ ($|V_1|=6$), $V_2 = \{1,2,3,4,5,6,7\}$ ($|V_2|=7$)。
    * 总结点数为 13 (奇数)。
    * 奇数个结点的二分图不是哈密顿图。
* **推论4**: 设G是哈密顿半图,则对任意的非空点集 $V_{1}\subset V(G)$,图 $G-V_{1}$ 中的连通支数不大于 $|V_{1}|+1$。
    * **示例：判断 H图 or H半图**
        * 图1: 令 $V_{1}=\{a,b\}$，则 $|V_{1}|=2$。 $G-V_{1}$ 中的连通支数为4 (结点1, 2, 3, 4)。 4 > $|V_1|+1 = 3$。因此该图不是H半图，也不是H图。
        * 图2: 令 $V_{1}=\{a,b,c,d,e\}$，则 $|V_{1}|=5$。 $G-V_{1}$ 中的连通支数为6 (结点1, 2, 3, 4, 5, 6)。 $6 = |V_1|+1$。 满足H半图的必要条件 (不排除是H半图)。